jdw/node-express:
  Env:
    - PORT: "3000"

  PkgInclude:
    - '*'

  PreBuild:
    - echo "---Begin PreBuild---"
    - echo "--Installing build dependencies--"
    - echo "-Installing nodejs-"
    - sudo apt-get update
    - sudo apt-get -y install nodejs
    - echo "-Installing npm-"
    - sudo apt-get -y install npm

  Build:
    - echo "---Begin Build--"
    - npm install

  PreInstall:
    - echo "---Begin PreInstall---"
    - echo "--Installing deploy dependencies--"
    - echo "-Installing nodejs-"
    - sudo apt-get update
    - sudo apt-get -y install nodejs-legacy
    - echo "-Installing npm-"
    - sudo apt-get -y install npm
    - sudo npm install -g pm2
 
  PostInstall:
    - echo "---Begin PostInstall---"
    - npm install

  PreStart:
    - echo "---Begin PreStart---"
    - sudo /usr/local/bin/pm2 -s kill

  Start:
    - echo "---Begin Start---"
    - sudo /usr/local/bin/pm2 -s start server.js