jdw/node-express:
  PreBuild:
    - echo "---Begin PreBuild---"
    - echo "--Installing build dependencies--"
    - echo "-Installing nodejs-"
    - sudo apt-get update
    - sudo apt-get -y install nodejs
    - echo "-Installing npm-"
    - sudo apt-get -y install npm

  Build:
    - echo "---Begin Build--"
    - npm install

  PkgInclude:
    - '*'

  PreInstall:
    - echo "---Begin PreInstall---"
    - echo "--Installing deploy dependencies--"
    - echo "-Installing nodejs-"
    - sudo apt-get update
    - sudo apt-get -y install nodejs-legacy
    - echo "-Installing npm-"
    - sudo apt-get -y install npm

  PostInstall:
    - echo "---Begin PostInstall---"
    - sudo npm install -g pm2
    - /usr/local/bin/pm2 -s kill
    - npm install

  Env:
    - PORT: "3000"

  Exec:
    - /usr/local/bin/pm2 -s start app.js
